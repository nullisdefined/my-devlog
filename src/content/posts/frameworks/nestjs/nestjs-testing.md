---
title: "[NestJS] 테스트(Test)"
slug: "nestjs-testing"
date: 2024-12-16
tags: ["NestJS", "Jest", "E2E", "UnitTest"]
category: "Frameworks/NestJS"
thumbnail: "https://nullisdefined.s3.ap-northeast-2.amazonaws.com/images/e48e6fd88f6339a761df1c6155770ce4.png"
draft: true
views: 0
---
![image](https://nullisdefined.s3.ap-northeast-2.amazonaws.com/images/e48e6fd88f6339a761df1c6155770ce4.png)

개발 공부를 하다 보면, 어느 순간 테스트 코드를 작성하라는 조언을 듣게 된다. 처음에는 솔직히 굉장히 귀찮고 번거로운 느낌이었다. 기능 하나 완성하는 것만으로도 힘든데, 테스트 코드를 또 따로 작성하라는 건 마치 두 번 일하는 기분이었다. 코드를 조금만 바꿔도 테스트 코드도 수정해야 하고, 차라리 Postman과 같은 툴로 직접 API를 호출해서 결과를 보는 게 지금 당장은 편하다고 느꼈다.
그런데도 많은 개발자들이, 특히 팀 단위로 일하는 환경에서는 테스트 코드 작성을 중요하게 생각한다. Jest나 Mocha같은 테스팅 프레임워크를 사용하고, E2E 테스트까지 구축하는 사례를 흔히 볼 수 있다. 왜 이런 번거로운 과정을 감수하고 테스트 코드를 작성하는 걸까? 궁금증이 생겼다.

## 테스트(Test)란?
테스트는 간단히 말해, 작성한 코드가 의도한 대로 동작하는지 검증하는 과정이다. 코드의 품질을 높이고, 안정성을 유지하기 위해 꼭 필요한 단계이지만, 처음 테스트를 접할 때는 그 효용성이 피부에 잘 와닿지 않을 수 있다.
### 테스트를 하는 이유
- **신뢰성 확보**: 새로운 기능을 추가하거나 기존 코드를 리팩토링해도, 테스트 코드를 통해 예상치 못한 문제가 생겼는지 쉽게 확인할 수 있다.
- **품질 유지와 개선**: 테스트가 잘 갖춰진 프로젝트는 시간이 지나도 품질을 유지하기 쉽다. 문제가 생겨도 어디서 문제가 발생했는지 찾기 수월하다.
- **회귀 방지**: 이전에 해결한 버그가 다시 나타나지 않도록 테스트로 검증할 수 있다. 한 번 잡은 문제를 테스트 코드에 남겨주면, 같은 문제가 재발할 때 바로 감지된다.
- **문서화**: 테스트 코드는 해당 기능이 어떻게 동작해야 하는지 스스로 설명한다. 기능 명세서나 사용 설명서처럼 동작하기 때문에, 나중에 로직을 이해하거나 유지보수하는 데 도움을 준다.

## 단위 테스트(Unit Test)
단위 테스트는 함수나 메서드 같은 작은 단위의 로직을 독립적으로 검증하는 것이다. 예를 들어, `sum(a, b)`라는 함수가 `a+b`를 올바르게 반환하는지 확인할 때, 다양한 입력값을 넣어보고 기대하는 결과가 나오는지 테스트하는 식이다. 복잡한 비즈니스 로직이나 DB 연동이 들어가기 시작하면 테스트 코드의 필요성이 점점 더 두드러진다.

## Jest란?
Jest는 JavaScript와 TypeScript 환경에서 가장 널리 쓰이는 테스트 프레임워크 중 하나다. Facebook(현 Meta)에서 개발했고, 다음과 같은 장점을 가진다.
- **직관적인 API**: `describe`, `it`, `expect`같은 키워드로 테스트를 쉽게 읽고, 쓸 수 있다.
- **쉬운 설정**: 별도의 복잡한 설정 없이 빠르게 테스트 환경을 구축할 수 있다.
- **스냅샷 테스트**: UI나 특정 출력 결과를 기록하고 비교하는 데 탁월한 기능을 제공한다.
- **빠른 실행 속도**: 변경이 있을 때마다 즉시 테스트를 재실행할 수 있어 개발 효율을 높여준다.

## NestJS 프로젝트에 Jest 적용하기
NestJS는 기본적으로 Jest와 잘 어울리며, CLI로 프로젝트를 생성했을 때 Jest 환경이 어느 정도 세팅되어 있다.

### 단위 테스트 예시